#include "spp_global.h"

#ifdef TEST_MAIN

int return_count = 0;
uint8_t aData3[16] = {0x7e,0x09,0x80,0x48,0x44,0x15,0x23,0x46,0x73,0x20,0x7d,0x4c,0x00,0x7f};
uint8_t aData4[16] = {0,0,0x7e,0x09,0x88,0x48,0xfb,0xa4,0xbe,0xdf,0x6f,0xa7,0xd9,0x48,0xb8,0x7f};
uint8_t aData6[16] = {0,0,0,0,0x7e,0x08,0x90,0xc8,0x43,0x21,0x44,0x95,0x08,0x18,0xb3,0x7f,0};
uint8_t aData5[16] = {0,0,0,0,0x7e,0x01,0xd0,0xd1,0x7f,0x01,0xc0,0xc0,0x7f,0};//RR
//uint8_t aData3[16] = {0,0,0,0,0x7e,0x02,0xc1,0x80,0x31,0x7f,0x01,0xc0,0xc0,0x7f,0};//RR
uint8_t aData1[16] = {0,0,0,0,0,0,0x7e,0x03,0x90,0x88,0xf9,0xf0,0x00,0x7f,0x7e,0x03};//RNR REJ
uint8_t aData2[16] = {0x98,0x88,0x1b,0x08,0x7f,0x08,0x01,0x03,0x7f,0x02,0xf8,0x81,0x18,0x80,0x7f};//RSET
uint8_t aData7[16] = {0x34,0x08,0x7e,0x01,0xE6,0xE7,0x7f,0x00,0,0,0,0,0};//UA

uint8_t* aDataArr[7] = {aData1,aData2,aData3,aData4,aData5,aData6,aData7};
#endif

/**
 * @function    调用底层SPI的读函数读取字节
 * @description 
 * @parameter
 * @return
*/
uint8_t ReadBytes(uint8_t *pBuffer,uint8_t nReadLength)
{
    if(return_count >= 7)
        return 0;
    uint8_t* pTargetArr;
    pTargetArr = aDataArr[return_count];
    return_count++;

#ifdef TEST_MAIN
    for(int i = 0; i < 16; i++)
        *pBuffer++ = *pTargetArr++;
    return 16;
#endif

    return 0;
}

uint8_t SPI_SEND_BYTES(uint8_t* pData,uint8_t nLength)
{
    printf("\n-------- send bytes as flow ----------\n\n");
    for(int index = 0; index < nLength; index++)
        printf("0x%02x ",*(pData+index));
    printf("\n\n--------------------------------------\n");
}

void* CMALLOC(uint32_t length)
{
    return (void*)malloc(length);
}

uint8_t CFREE(void* pFreeAddress)
{
    free(pFreeAddress);
    return 1;
}