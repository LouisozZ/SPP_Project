#include "spp_include.h"

#ifdef TEST_MAIN

int return_count = 0;
uint8_t aData1[16] = {0x7e,0x09,0x80,0x00,0x15,0x23,0x46,0x73,0x20,0x7d,0x7d,0xcc,0x80,0x7f};
uint8_t aData2[16] = {0,0,0x7e,0x09,0x80,0x00,0x49,0x7d,0xbe,0xdf,0x4f,0xb2,0x94,0x36,0xe0,0x7f};
uint8_t aData7[16] = {0,0,0,0,0x7e,0x07,0x80,0x80,0x21,0x44,0x95,0x08,0x18,0x44,0x7f,0};
uint8_t aData3[16] = {0,0,0,0,0x7e,0x02,0xc1,0x80,0x31,0x7f,0x01,0xc0,0xc0,0x7f,0};//RR
uint8_t aData4[16] = {0,0,0,0,0x7e,0x02,0xD2,0x80,0x31,0x7f,0x04,0x06,0x7f,0x07,0x7e,0x02};//RNR REJ
uint8_t aData5[16] = {0xcd,0x80,0x31,0x7f,0x76,0x08,0x01,0x03,0x7e,0x02,0xf8,0x81,0x18,0x80,0x7f};//RSET
uint8_t aData6[16] = {0x34,0x08,0x7e,0x01,0xE6,0xE6,0x7f,0x00,0,0,0,0,0};//UA

uint8_t* aDataArr[7] = {aData1,aData2,aData3,aData4,aData5,aData6,aData7};
#endif

/**
 * @function    调用底层SPI的读函数读取字节
 * @description 
 * @parameter
 * @return
*/
uint8_t ReadBytes(uint8_t *pBuffer,uint8_t nReadLength)
{
    if(return_count >= 7)
        return 0;
    uint8_t* pTargetArr;
    pTargetArr = aDataArr[return_count];
    return_count++;

#ifdef TEST_MAIN
    for(int i = 0; i < 16; i++)
        *pBuffer++ = *pTargetArr++;
    return 16;
#endif

    return 0;
}

void* CMALLOC(uint32_t length)
{
    return (void*)malloc(length);
}

uint8_t CFREE(void* pFreeAddress)
{
    free(pFreeAddress);
    return 1;
}